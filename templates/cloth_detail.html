{% extends "base.html" %}
{% load static %}
{% block title %}{{ cloth.name }} | Rentify{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<link rel="stylesheet" href="{% static 'css/list.css' %}">
{% endblock %}

{% block content %}
<div class="container py-5">

<div class="row g-4">

    <!-- IMAGE -->
    <div class="col-md-5">
        <div class="card border-0 shadow-sm">
            <img src="{{ cloth.image.url }}"
                 class="img-fluid rounded"
                 alt="{{ cloth.name }}">
        </div>
    </div>

    <!-- DETAILS -->
    <div class="col-md-7">

        <h3 class="fw-bold mb-2">
            {{ cloth.name }}
        </h3>

        <!-- CATEGORIES -->
        <div class="mb-3">
            {% for cat in cloth.categories.all %}
                <span class="badge bg-light text-dark me-1">
                    {{ cat.name }}
                </span>
            {% endfor %}
        </div>

        <h4 class="text-danger fw-bold mb-3">
            â‚¹{{ cloth.rent_per_day }} <span class="fs-6 text-muted">/ day</span>
        </h4>

        <p>
            <strong>Condition:</strong>
            {{ cloth.get_condition_display }}
        </p>

        <p>
            <strong>Available Quantity:</strong>
            {{ cloth.quantity }}
        </p>

        {% if seller_profile %}
        <hr>
        <p>
            <strong>Seller:</strong>
            {{ seller_profile.store_name }}
        </p>

        {% if seller_profile.pickup_address %}
        <p>
            <strong>Pickup Area:</strong>
            {{ seller_profile.pickup_address.city }},
            {{ seller_profile.pickup_address.pincode }}
        </p>
        {% endif %}
        {% endif %}

        {% if cloth.description %}
        <p class="mt-3 text-muted">
            {{ cloth.description }}
        </p>
        {% endif %}

        <hr>

        <!-- ACTION BUTTONS -->
        {% if not user.is_authenticated %}
            <a href="{% url 'login' %}"
               class="btn btn-outline-danger px-4">
                Login to Rent
            </a>

        {% elif user.is_buyer %}
            {% if already_requested %}
    <button class="btn btn-secondary w-100" disabled>
        Request Already Sent
    </button>

    <p class="text-muted small text-center mt-2">
        You can manage this request from <b>My Account</b>
    </p>
{% else %}
    <form method="post" action="{% url 'request_cloth' cloth.id %}">
        {% csrf_token %}
        <!-- quantity, days, pickup date -->
        <button type="submit" class="btn btn-danger w-100">
            Send Rental Request
        </button>
    </form>
{% endif %}


        {% else %}
            <div class="alert alert-warning">
                Sellers cannot rent clothes.
            </div>
        {% endif %}

    </div>

</div>

</div>
{% endblock %}
